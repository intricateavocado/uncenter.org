<!DOCTYPE html>
<html lang="en">
    <head>
        {% include "partials/head.njk" %}
        <link rel="preload" as="font" type="font/woff2" href="/assets/fonts/GeneralSans-Variable.woff2?v=20230514" crossorigin="anonymous">
        <link rel="stylesheet" href="/assets/styles.css">
        {% if styles %}
            {% for style in (styles | toArray) %}<link rel="stylesheet" href="/assets/css/{{ style }}">{% endfor %}
        {% endif %}
        <style>
            {{inlined.css | safe}}
        </style>
        <script>
            function loadGiscus() {
                if (!document.querySelector('#comments')) {
                    console.warn(`Giscus: #comments element not found (ignore if this isn't a blog post).`);
                    return;
                }
                let giscusAttributes = {
                    src: 'https://giscus.app/client.js',
                    'data-repo': '{{ meta.github.username }}/{{ meta.github.repo }}',
                    'data-repo-id': 'R_kgDOHSjhjQ',
                    'data-category-id': 'DIC_kwDOHSjhjc4CTQUr',
                    'data-mapping': 'title',
                    'data-reactions-enabled': '1',
                    'data-emit-metadata': '0',
                    'data-input-position': 'top',
                    'data-theme': document
                        .documentElement
                        .getAttribute('theme'),
                    'data-lang': 'en',
                    crossorigin: 'anonymous',
                    async: ''
                };
                let giscusScript = document.createElement('script');
                Object
                    .entries(giscusAttributes)
                    .forEach(([key, value]) => giscusScript.setAttribute(key, value),);
                document
                    .querySelector('#comments')
                    .innerHTML = '';
                document
                    .querySelector('#comments')
                    .appendChild(giscusScript);
            }
            {{ inlined.js.before | safe }}
        </script>
    </head>
    <body class="mx-4 my-12 p-4 bg-bg text-fg font-display">
        {{ content | safe }}
    </body>
    <script>
        window.addEventListener('load', loadGiscus);
        {{ inlined.js.after | safe }}
    </script>
    {% if scripts %}
        {% for script in (scripts | toArray) %}
            <script src="/assets/scripts/{{script}}"></script>
        {% endfor %}
    {% endif %}
</html>